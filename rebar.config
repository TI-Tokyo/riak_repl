%%-*- mode: erlang -*-
{minimum_otp_vsn, "22.0"}.

{deps,
 [{lager, {git, "https://github.com/erlang-lager/lager.git", {tag, "3.8.0"}}},
  {ranch, {git, "https://github.com/ninenines/ranch.git", {tag, "1.6.0"}}},
  {ebloom,{git, "https://github.com/basho/ebloom.git", {tag, "2.1.0"}}},
  {riak_kv, {git, "https://github.com/TI-Tokyo/riak_kv.git", {branch, "riak_ts-develop-3.0"}}}
 ]}.

{plugins,
 [{rebar3_gpb_plugin, {git, "https://github.com/basho/rebar3_gpb_plugin", {tag, "2.15.1+riak.3.0.4"}}},
  {eqc_rebar, {git, "https://github.com/Quviq/eqc-rebar", {branch, "master"}}}
 ]
}.

{erl_opts,
 [debug_info,
  warnings_as_errors,
  {i, "./_build/default/plugins/gpb/include"},
  {parse_transform, lager_transform}
 ]
}.

{erl_first_files,
 ["src/gen_leader.erl"
 ]
}.

{gpb_opts,
 [{module_name_suffix, "_pb"},
  {msg_name_to_lower, true},
  {i, "src"}
 ]
}.

{provider_hooks,
 [{pre, [{compile, {protobuf, compile}}]}
 ]
}.

{cover_enabled, true}.

{profiles,
 [{test,
   [{deps, [meck]}
   ]
  },
  {eqc,
   [{deps, [meck]}, {erl_opts, [{d, 'EQC'}]}]}
 ]
}.
